{"ast":null,"code":"var _jsxFileName = \"D:\\\\bd2\\\\client\\\\src\\\\contexts\\\\NotificationContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { api } from '../lib/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet ws = null;\nconst NotificationContext = /*#__PURE__*/createContext();\nexport const useNotifications = () => {\n  _s();\n  const context = useContext(NotificationContext);\n  if (!context) {\n    throw new Error('useNotifications must be used within a NotificationProvider');\n  }\n  return context;\n};\n_s(useNotifications, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const NotificationProvider = ({\n  children\n}) => {\n  _s2();\n  const [notifications, setNotifications] = useState([]);\n  const [unreadCount, setUnreadCount] = useState(0);\n  useEffect(() => {\n    // Update unread count whenever notifications change\n    const newUnreadCount = notifications.filter(notif => !notif.read).length;\n    setUnreadCount(newUnreadCount);\n  }, [notifications]);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    if (!token) return;\n\n    // Initialize WebSocket connection\n    ws = new WebSocket(`ws://localhost:5000?token=${token}`);\n    ws.onopen = () => {\n      console.log('WebSocket connected');\n    };\n    ws.onmessage = event => {\n      try {\n        const notification = JSON.parse(event.data);\n        addNotification({\n          id: Date.now(),\n          ...notification,\n          read: false\n        });\n      } catch (error) {\n        console.error('Failed to parse notification:', error);\n      }\n    };\n    ws.onerror = error => {\n      console.error('WebSocket error:', error);\n    };\n    ws.onclose = () => {\n      console.log('WebSocket disconnected');\n    };\n    return () => {\n      if (ws) {\n        ws.close();\n      }\n    };\n  }, []);\n  const addNotification = notification => {\n    setNotifications(prev => [notification, ...prev]);\n  };\n  const markAsRead = notificationId => {\n    setNotifications(prev => prev.map(notif => notif.id === notificationId ? {\n      ...notif,\n      read: true\n    } : notif));\n  };\n  const markAllAsRead = () => {\n    setNotifications(prev => prev.map(notif => ({\n      ...notif,\n      read: true\n    })));\n  };\n  const clearNotifications = () => {\n    setNotifications([]);\n  };\n  return /*#__PURE__*/_jsxDEV(NotificationContext.Provider, {\n    value: {\n      notifications,\n      unreadCount,\n      addNotification,\n      markAsRead,\n      markAllAsRead,\n      clearNotifications\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n};\n_s2(NotificationProvider, \"fcYyFBxas/dQ9m1yYSroPQK4cZg=\");\n_c = NotificationProvider;\nvar _c;\n$RefreshReg$(_c, \"NotificationProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","jsxDEV","_jsxDEV","ws","NotificationContext","useNotifications","_s","context","Error","NotificationProvider","children","_s2","notifications","setNotifications","unreadCount","setUnreadCount","newUnreadCount","filter","notif","read","length","token","localStorage","getItem","WebSocket","onopen","console","log","onmessage","event","notification","JSON","parse","data","addNotification","id","Date","now","error","onerror","onclose","close","prev","markAsRead","notificationId","map","markAllAsRead","clearNotifications","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/bd2/client/src/contexts/NotificationContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport { api } from '../lib/api';\r\n\r\nlet ws = null;\r\n\r\nconst NotificationContext = createContext();\r\n\r\nexport const useNotifications = () => {\r\n  const context = useContext(NotificationContext);\r\n  if (!context) {\r\n    throw new Error('useNotifications must be used within a NotificationProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    // Update unread count whenever notifications change\r\n    const newUnreadCount = notifications.filter(notif => !notif.read).length;\r\n    setUnreadCount(newUnreadCount);\r\n  }, [notifications]);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    if (!token) return;\r\n\r\n    // Initialize WebSocket connection\r\n    ws = new WebSocket(`ws://localhost:5000?token=${token}`);\r\n\r\n    ws.onopen = () => {\r\n      console.log('WebSocket connected');\r\n    };\r\n\r\n    ws.onmessage = (event) => {\r\n      try {\r\n        const notification = JSON.parse(event.data);\r\n        addNotification({\r\n          id: Date.now(),\r\n          ...notification,\r\n          read: false\r\n        });\r\n      } catch (error) {\r\n        console.error('Failed to parse notification:', error);\r\n      }\r\n    };\r\n\r\n    ws.onerror = (error) => {\r\n      console.error('WebSocket error:', error);\r\n    };\r\n\r\n    ws.onclose = () => {\r\n      console.log('WebSocket disconnected');\r\n    };\r\n\r\n    return () => {\r\n      if (ws) {\r\n        ws.close();\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const addNotification = (notification) => {\r\n    setNotifications(prev => [notification, ...prev]);\r\n  };\r\n\r\n  const markAsRead = (notificationId) => {\r\n    setNotifications(prev =>\r\n      prev.map(notif =>\r\n        notif.id === notificationId\r\n          ? { ...notif, read: true }\r\n          : notif\r\n      )\r\n    );\r\n  };\r\n\r\n  const markAllAsRead = () => {\r\n    setNotifications(prev =>\r\n      prev.map(notif => ({ ...notif, read: true }))\r\n    );\r\n  };\r\n\r\n  const clearNotifications = () => {\r\n    setNotifications([]);\r\n  };\r\n\r\n  return (\r\n    <NotificationContext.Provider\r\n      value={{\r\n        notifications,\r\n        unreadCount,\r\n        addNotification,\r\n        markAsRead,\r\n        markAllAsRead,\r\n        clearNotifications\r\n      }}\r\n    >\r\n      {children}\r\n    </NotificationContext.Provider>\r\n  );\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}